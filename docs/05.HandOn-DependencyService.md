# DependencyServiceをDependencyInjectionに置き換える

23. TextSpeechPageViewModelTestのテストを実行する  
-> Xamarin.Forms.Initが呼ばれていないエラーが発生することを確認する  
24. TextSpeechPageViewModelを開き、Speechメソッドの実装を全削除  
25. TextSpeechPageViewModelのコンストラクタにITextToSpeechServiceをインジェクションしフィールドへ保持  
26. ITextToSpeechServiceTestを開き、テストコードの実装  
-> テストを実行 -> エラー  
27. TextSpeechPageViewModelのSpeechメソッドを実装  
-> テストを実行 -> 成功  
28. カバレッジが取得できるなら取得してみる（オプション）  
-> SpeechCommandがカバレッジを通過していないのを確認する  
29. テストコードを修正し、コマンドを実行するように修正する  
-> テストを実行 -> 成功＆カバレッジ100%  
30. TextSpeechPageのBindingContextへViewModelを設定している箇所を削除し、ViewModelLocatorに変更する  
-> デバッグ実行 -> すべて正しく動作することを確認する  
